import{D as p}from"./autocomplete-BhlH6aML.js";const u={threshold:2,maximumItems:5,highlightTyped:!0,highlightClass:"text-primary",label:"label",value:"value",showValue:!1,showValueBeforeLabel:!1};class b{constructor(t,e){this.field=t,this.options=Object.assign({},u,e),this.dropdown=null,t.parentNode.classList.add("dropdown"),t.setAttribute("data-bs-toggle","dropdown"),t.classList.add("dropdown-toggle");const s=h('<div class="dropdown-menu"></div>');this.options.dropdownClass&&s.classList.add(this.options.dropdownClass),c(s,t),this.dropdown=new p(t,this.options.dropdownOptions),t.addEventListener("click",i=>{this.createItems()===0&&(i.stopPropagation(),this.dropdown.hide())}),t.addEventListener("input",()=>{this.options.onInput&&this.options.onInput(this.field.value),this.renderIfNeeded()}),t.addEventListener("keydown",i=>{var o;if(i.keyCode===27){this.dropdown.hide();return}if(i.keyCode===40){(o=this.dropdown._menu.children[0])==null||o.focus();return}})}setData(t){this.options.data=t,this.renderIfNeeded()}renderIfNeeded(){this.createItems()>0?this.dropdown.show():this.field.click()}createItem(t,e){let s;if(this.options.highlightTyped){const i=d(e.label).toLowerCase().indexOf(d(t).toLowerCase()),o=Array.isArray(this.options.highlightClass)?this.options.highlightClass.join(" "):typeof this.options.highlightClass=="string"?this.options.highlightClass:"";s=e.label.substring(0,i)+`<span class="${o}">${e.label.substring(i,i+t.length)}</span>`+e.label.substring(i+t.length,e.label.length)}else s=e.label;return this.options.showValue&&(this.options.showValueBeforeLabel?s=`${e.value} ${s}`:s+=` ${e.value}`),h(`<button type="button" class="dropdown-item" data-label="${e.label}" data-value="${e.value}">${s}</button>`)}createItems(){const t=this.field.value;if(t.length<this.options.threshold)return this.dropdown.hide(),0;const e=this.field.nextSibling;e.innerHTML="";const s=Object.keys(this.options.data);let i=0;for(let o=0;o<s.length;o++){const l=s[o],a=this.options.data[l],r={label:this.options.label?a[this.options.label]:l,value:this.options.value?a[this.options.value]:a};if(d(r.label).toLowerCase().indexOf(d(t).toLowerCase())>=0&&(e.appendChild(this.createItem(t,r)),this.options.maximumItems>0&&++i>=this.options.maximumItems))break}return this.field.nextSibling.querySelectorAll(".dropdown-item").forEach(o=>{o.addEventListener("click",l=>{let a=l.currentTarget.getAttribute("data-label"),r=l.currentTarget.getAttribute("data-value");this.field.value=a,this.options.onSelectItem&&this.options.onSelectItem({value:r,label:a}),this.dropdown.hide()})}),e.childNodes.length}}function h(n){let t=document.createElement("div");return t.innerHTML=n,t.firstChild}function c(n,t){return t.parentNode.insertBefore(n,t.nextSibling)}function d(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}export{b as A};
