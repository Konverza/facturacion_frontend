import{A as d}from"./autocomplete-i5sh6eXG.js";import{L as r}from"./maska-X9fHs--r.js";import"./autocomplete-BhlH6aML.js";$(function(){const l=$("#numDocumento");let a=null,s=null,m=null;const u=$("#nrc");new r(u,{mask:"######-#"}),$.ajax({url:"/catalogo/cat_019",success:function(t){const o=document.getElementById("codActividad");new d(o,{data:t,maximumItems:5,threshold:1}),s=t}}),$.ajax({url:"/catalogo/cat_020",success:function(t){const o=document.getElementById("codPais");new d(o,{data:t,maximumItems:5,threshold:1}),m=t}}),$.ajax({url:"/departamentos/all",success:function(t){const o=$("#departamento");o.empty(),t.forEach(i=>{o.append(new Option(i.valores,i.codigo))}),o.on("change",function(){const i=$(this).val(),e=$("#municipio");e.empty(),i&&t.find(n=>n.codigo===i).municipios.forEach(n=>{e.append(new Option(n.valores,n.codigo))})}),o.trigger("change")}}),$("#customerTable tfoot th").each(function(){if($(this).index()<$("#customerTable tfoot th").length-1){var t=$(this).text();$(this).html('<input class="form-control form-control-sm" type="text" placeholder="Buscar '+t+'" />')}else $(this).html("")}),$("#customerTable").DataTable({initComplete:function(){this.api().columns().every(function(){var t=this;$("input",this.footer()).on("keyup change clear",function(){t.search()!==this.value&&t.search(this.value).draw()})})},language:{lengthMenu:"Mostrar _MENU_ registros por página",zeroRecords:"No se encontraron resultados",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No hay registros disponibles",infoFiltered:"(filtrado de _MAX_ registros totales)",search:"Buscar:",paginate:{first:"Primero",last:"Último",next:"Siguiente",previous:"Anterior"}},dom:'<"container-fluid"<"row"<"col"l><"col"B><"col"f>>>rtip',buttons:[{extend:"print",text:"Imprimir esta tabla",title:"Reporte de Clientes"}],order:[[0,"desc"]]}),$("#tipoDocumento").on("change",function(){let t=$(this).val();t=="36"?a=new r(l,{mask:"####-######-###-#"}):t=="13"?a=new r(l,{mask:"########-#"}):(a.destroy(),a=null)}),$("#clienteExportacion").on("change",function(){$(this).is(":checked")?($("#codPais").prop("disabled",!1),$("#tipoPersona").prop("disabled",!1)):($("#codPais").prop("disabled",!0),$("#tipoPersona").prop("disabled",!0))}),$("#clienteExportacion").trigger("change"),$("#formCliente").on("submit",function(t){t.preventDefault();let o=$(this).serializeArray();(o.tipoDocumento=="36"||o.tipoDocumento=="13")&&(o.numDocumento=o.numDocumento.replace(/-/g,"")),$.ajax({url:$(this).attr("action"),type:$(this).attr("method"),data:o,success:function(i){i.success?Swal.fire({icon:"success",title:"Cliente guardado",text:i.message,confirmButtonText:"Aceptar"}).then(e=>{window.location.reload()}):Swal.fire({icon:"error",title:"Error al guardar",text:i.message,confirmButtonText:"Aceptar"})}})}),$(".frm-delete").on("submit",function(t){t.preventDefault(),Swal.fire({title:"¿Está seguro de eliminar este cliente?",text:"¡No podrá revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(o=>{if(o.isConfirmed){let i=$(this).serializeArray();$.ajax({url:$(this).attr("action"),type:$(this).attr("method"),data:i,success:function(e){e.success?Swal.fire({icon:"success",title:"Cliente eliminado",text:e.message,confirmButtonText:"Aceptar"}).then(c=>{window.location.reload()}):Swal.fire({icon:"error",title:"Error al eliminar",text:e.message,confirmButtonText:"Aceptar"})}})}})}),$(document).on("show.bs.modal","#aggCliente",function(t){let i=$(t.relatedTarget).data("id");i&&$.ajax({url:"/business/clientes/"+i,success:function(e){$("#formCliente").attr("action","/business/clientes/"+i),$("#formCliente").attr("method","PUT"),$("#formCliente").find("#tipoDocumento").val(e.tipoDocumento),$("#formCliente").find("#numDocumento").val(e.numDocumento),$("#formCliente").find("#nombre").val(e.nombre),$("#formCliente").find("#nrc").val(e.nrc),$("#formCliente").find("#nombreComercial").val(e.nombreComercial);const c=s.find(n=>n.value===e.codActividad);if(c&&$("#codActividad").val(c.label),$("#formCliente").find("#departamento").val(e.departamento),$("#formCliente").find("#departamento").trigger("change"),$("#formCliente").find("#municipio").val(e.municipio),$("#formCliente").find("#complemento").val(e.complemento),$("#formCliente").find("#telefono").val(e.telefono),$("#formCliente").find("#correo").val(e.correo),e.codPais){$("#clienteExportacion").prop("checked",!0),$("#codPais").prop("disabled",!1),$("#tipoPersona").prop("disabled",!1),$("#formCliente").find("#tipoPersona").val(parseInt(e.tipoPersona));const n=m.find(f=>f.value===e.codPais);n&&$("#codPais").val(n.label)}}})})});
